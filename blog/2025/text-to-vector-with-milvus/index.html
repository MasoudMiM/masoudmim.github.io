<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Turning Text into a Vector Database with Milvus | Masoud Masoumi</title> <meta name="author" content="Masoud Masoumi"> <meta name="description" content="Simple tutorial for converting a text to a vector database."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://masoudmim.github.io/blog/2025/text-to-vector-with-milvus/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Masoud Masoumi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Turning Text into a Vector Database with Milvus</h1> <p class="post-meta">April 13, 2025</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/vector"> <i class="fa-solid fa-hashtag fa-sm"></i> vector</a>   <a href="/blog/tag/database"> <i class="fa-solid fa-hashtag fa-sm"></i> database,</a>   <a href="/blog/tag/milvus"> <i class="fa-solid fa-hashtag fa-sm"></i> Milvus</a>     ·   <a href="/blog/category/technical"> <i class="fa-solid fa-tag fa-sm"></i> technical</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>In this tutorial, I am going to provide the steps required to convert a text into a vector database for easy searching and retrieval. The goal is to walk you through the process using a Python script that uses <a href="https://milvus.io/" rel="external nofollow noopener" target="_blank">Milvus</a> and <a href="https://huggingface.co/sentence-transformers" rel="external nofollow noopener" target="_blank">Sentence Transformers</a>. You can find the complete script in this <a href="https://github.com/MasoudMiM/text-to-vector" rel="external nofollow noopener" target="_blank">GitHub repo</a>.</p> <h2 id="what-you-need">What You Need</h2> <p>Before we get started, make sure you have the following:</p> <ol> <li> <strong>Milvus</strong>: You need a running instance of Milvus. Check out the <a href="https://milvus.io/docs/install_standalone-docker.md" rel="external nofollow noopener" target="_blank">Milvus installation guide</a> if you haven’t set it up yet.</li> <li> <p><strong>Python Packages</strong>: Install the required packages with this command:</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>nltk sentence-transformers pymilvus
</code></pre></div> </div> </li> <li> <strong>Your Text</strong>: Have a text file ready that you want to convert into a vector database. Just name it <code class="language-plaintext highlighter-rouge">text.txt</code> and place it in a <code class="language-plaintext highlighter-rouge">data</code> folder.</li> </ol> <h2 id="the-code">The Code</h2> <p>The script reads your text, processes it, and stores it in a Milvus collection. Here’s a quick overview of how it works:</p> <ol> <li> <strong>Read the Text</strong>: The script starts by reading the content of your <code class="language-plaintext highlighter-rouge">text.txt</code> file. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">read_text_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
     <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
         <span class="k">return</span> <span class="nb">file</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
</code></pre></div> </div> </li> <li> <strong>Tokenization</strong>: It breaks the text into sentences and then chunks them into manageable pieces. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="n">sentences</span> <span class="o">=</span> <span class="nf">sent_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <strong>Generate Embeddings</strong>: Using the <code class="language-plaintext highlighter-rouge">all-MiniLM-L6-v2</code> model from Sentence Transformers, the script converts these text chunks into numerical embeddings. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="n">model</span> <span class="o">=</span> <span class="nc">SentenceTransformer</span><span class="p">(</span><span class="sh">'</span><span class="s">all-MiniLM-L6-v2</span><span class="sh">'</span><span class="p">)</span>

 <span class="n">text_chunks</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>

 <span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">text_chunks</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <strong>Connect to Milvus</strong>: It establishes a connection to your Milvus instance. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">connect_to_milvus</span><span class="p">():</span>
     <span class="n">connections</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="sh">"</span><span class="s">default</span><span class="sh">"</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="sh">"</span><span class="s">localhost</span><span class="sh">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="sh">"</span><span class="s">19530</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <strong>Create a Collection</strong>: A new collection is created in Milvus to store the embeddings and the original text. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="nf">connect_to_milvus</span><span class="p">()</span>
 <span class="n">collection_name</span> <span class="o">=</span> <span class="n">MILVUS_COLLEC_NAME</span>

 <span class="k">def</span> <span class="nf">create_milvus_collection</span><span class="p">(</span><span class="n">collection_name</span><span class="p">):</span>
     <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
         <span class="nc">FieldSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="p">.</span><span class="n">INT64</span><span class="p">,</span> <span class="n">is_primary</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">auto_id</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
         <span class="nc">FieldSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">embedding</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="p">.</span><span class="n">FLOAT_VECTOR</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">384</span><span class="p">),</span>  
         <span class="nc">FieldSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="p">.</span><span class="n">VARCHAR</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">65535</span><span class="p">)</span>  
     <span class="p">]</span>
     <span class="n">schema</span> <span class="o">=</span> <span class="nc">CollectionSchema</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">Vector database for Common Sense.</span><span class="sh">"</span><span class="p">)</span>
     <span class="n">collection</span> <span class="o">=</span> <span class="nc">Collection</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">collection_name</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">collection</span>

 <span class="n">collection</span> <span class="o">=</span> <span class="nf">create_milvus_collection</span><span class="p">(</span><span class="n">collection_name</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <strong>Insert Data</strong>: Finally, the embeddings and text are inserted into the collection, making them ready for efficient searching. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">insert_vectors_to_milvus</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">embeddings_list</span><span class="p">,</span> <span class="n">original_texts</span><span class="p">):</span>
     <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Number of embeddings: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">embeddings_list</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
     <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
         <span class="p">{</span><span class="sh">"</span><span class="s">embedding</span><span class="sh">"</span><span class="p">:</span> <span class="n">embedding</span><span class="p">,</span> <span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="p">:</span> <span class="n">original_text</span><span class="p">}</span> 
         <span class="k">for</span> <span class="n">embedding</span><span class="p">,</span> <span class="n">original_text</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">embeddings_list</span><span class="p">,</span> <span class="n">original_texts</span><span class="p">)</span>
     <span class="p">]</span>
        
     <span class="k">try</span><span class="p">:</span>
         <span class="n">collection</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
         <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Inserted </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">embeddings_list</span><span class="p">)</span><span class="si">}</span><span class="s"> vectors into Milvus.</span><span class="sh">"</span><span class="p">)</span>
     <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
         <span class="n">logging</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed to insert data into Milvus: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

 <span class="nf">insert_vectors_to_milvus</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">embeddings_list</span><span class="p">,</span> <span class="n">text_chunks</span><span class="p">)</span>
</code></pre></div> </div> </li> </ol> <h2 id="whats-next">What’s Next?</h2> <p>After running the script, you’ll have a Milvus collection filled with your text data, ready for querying. You can now perform similarity searches and retrieve relevant information quickly and efficiently. Here is an example of how the output collection can look like in <a href="https://milvus.io/docs/v2.0.x/attu.md" rel="external nofollow noopener" target="_blank">attu interface</a>.</p> <p><br></p> <div style="text-align: center;"> <img src="/assets/img/db_example_attu.png" alt="attu showing the vector database" width="600"> </div> <p><br></p> <p>You have now successfully converted text into a vector database using Milvus. One exciting application of this approach is in Retrieval-Augmented Generation (RAG). By storing your text data in a vector database, you can enhance the capabilities of language models. When generating responses, the model can retrieve relevant information from the database, leading to more accurate and contextually relevant outputs. This is particularly useful in applications like chatbots, content generation, and question-answering systems.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/transformers/">Transformers - Fundamental Concepts with Python Implementation</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/svd/">Dynamic Mode Decomposition for Fluid Dynamics</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/repair-minset/">Embracing the Repair Mindset</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/problem-solving/">Data-Driven vs. First-Principles</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/execution/">Ideas Matter More Than Ever</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023-2025 Masoud Masoumi. Modified by Masoud Masoumi based on the <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>